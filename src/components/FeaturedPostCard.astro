---
import { Image } from 'astro:assets';

export interface Props {
  /**
   * Post slug for URL generation
   */
  slug: string;
  /**
   * Post title
   */
  title: string;
  /**
   * YouTube video ID (optional)
   */
  youtubeId?: string;
  /**
   * Hero image URL (optional)
   */
  heroImage?: string;
  /**
   * Additional CSS classes to apply
   */
  class?: string;
}

const { 
  slug, 
  title, 
  youtubeId, 
  heroImage, 
  class: className = '' 
} = Astro.props;

const postUrl = slug.startsWith('drafts/') ? `/blog/${slug}/` : `/blog/${slug}/`;
---

<article class={`featured-post-card bg-secondary/50 rounded-lg border border-tertiary overflow-hidden hover:border-highlight/40 transition-all duration-200 group ${className}`}>
  <a href={postUrl} class="block">
    <!-- Image Section with proper 16:9 aspect ratio -->
    <div class="w-full aspect-video">
      {youtubeId ? (
        <Image 
          src={`https://img.youtube.com/vi/${youtubeId}/hqdefault.jpg`}
          alt={title}
          class="w-full h-full object-cover transition-transform group-hover:scale-105"
          width={480}
          height={360}
          loading="lazy"
        />
      ) : heroImage ? (
        <Image 
          src={heroImage}
          alt={title}
          class="w-full h-full object-cover transition-transform group-hover:scale-105"
          width={480}
          height={360}
          loading="lazy"
        />
      ) : (
        <div class="w-full h-full bg-accent flex items-center justify-center">
          <svg class="w-12 h-12 text-text-muted" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9.5a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />
          </svg>
        </div>
      )}
    </div>
    
    <!-- Content Section -->
    <div class="p-4">
      <!-- Draft indicator for development -->
      {import.meta.env.DEV && slug.startsWith('drafts/') && (
        <div class="inline-flex items-center gap-1 px-2 py-1 bg-warm/20 border border-warm rounded text-xs font-heading font-medium text-warm mb-2">
          <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
          </svg>
          Draft
        </div>
      )}
      
      <h3 class="text-base sm:text-lg font-heading font-semibold text-text-primary line-clamp-2 group-hover:text-highlight transition-colors leading-tight">
        {title}
      </h3>
    </div>
  </a>
</article>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  @media (max-width: 640px) {
    .featured-post-card .line-clamp-2 {
      -webkit-line-clamp: 3;
    }
  }
</style>
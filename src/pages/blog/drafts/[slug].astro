---
import { getCollection } from 'astro:content';
import BlogPost from '../../../layouts/BlogPost.astro';

export async function getStaticPaths() {
  // Only include draft posts in development
  if (!import.meta.env.DEV) {
    return []; // No draft routes in production
  }
  
  const posts = await getCollection('blog', ({ slug }) => {
    return slug.startsWith('drafts/'); // Only include drafts
  });
  
  return posts.map((post) => ({
    params: { slug: post.slug.replace('drafts/', '') }, // Remove drafts/ prefix from URL
    props: post,
  }));
}

const post = Astro.props;
const { Content } = await post.render();
---

<BlogPost {...post.data}>
  <Content />
</BlogPost>